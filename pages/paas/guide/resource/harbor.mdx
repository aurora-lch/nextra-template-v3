# 镜像仓库

提供可靠的镜像仓库服务，支持多集镜像库管理；具备镜像仓库的备份与还原功能，支持镜像分发和同步，保证镜像远程同步的高性能，支持为不同的租户提供不同的镜像版本私库。

![HQmLbw5xmocKSkxQ6ATchZi6n3d](/static/HQmLbw5xmocKSkxQ6ATchZi6n3d.png)

## **使用方法**

- **浏览镜像库**：在【镜像仓库】页面，查看所有的镜像仓库。
- **筛选镜像库**：可通过在列表上方搜索栏输入镜像库名称，点击【查询】，查找特定的镜像库。
- **新增镜像库**：在【镜像仓库】页面，点击【新增镜像库】进入新增镜像库向导页面。

| **配置项**   | **描述**                                                     |
| ------------ | ------------------------------------------------------------ |
| 镜像仓库名称 | 提供镜像仓库的名称。                                         |
| 外网地址     | 外网可访问地址，用于一台服务器有两个 IP 地址的情况格式：[http://127.0.0.1](http://127.0.0.1:5000) |
| 内网地址     | 内网可访问地址，用于一台服务器有两个 IP 地址的情况格式：[http://127.0.0.1](http://127.0.0.1:5000) |
| 镜像库类型   | **公共镜像库**：一种对所有用户开放的镜像库，允许任何人浏览、拉取（pull）镜像，但通常只允许授权用户推送（push）镜像。**普通镜像库**：一种私有的镜像库，只有授权用户才能访问、拉取和推送镜像。 |
| 备注         | 输入关于镜像库的备注内容，如用途、创建者、使用说明等。       |

- **管理镜像库**：从镜像库列表中选择对镜像库进行操作。
- **更新**

点击【更新】按钮对镜像库的名称、外网地址 、内网地址、类型和备注进行更新。

- **详情**

点击【详情】按钮查看镜像库的详情。

1. 项目

![PaxZbxZn7o9X4xxE9yKc2PHEnYb](/static/PaxZbxZn7o9X4xxE9yKc2PHEnYb.png)

- 在【项目】页面，可查看当前项目和镜像仓库的数量。如有多页，点击右下方翻页按钮 \<、> 或具体页数，可查看对应页面信息。
- 点击【新增项目】可设置【项目名称】和【访问级别】，如设为公开，任何人都有此项目下镜像的读取权限。

2. 仓库管理

![EsNAbvx5Io70XCx8y3KcemntnEh](/static/EsNAbvx5Io70XCx8y3KcemntnEh.png)

- 在【仓库管理】页面，可查看仓库的目标、状态、目标 URL、提供者、验证远程证书、认证和创建时间。如有多页，点击右下方翻页按钮 \<、> 或具体页数，可查看对应页面信息。
- 通过【操作】可对相应目标进行【查看/更新】或【删除】。
- 新增目标：点击【新增目标】可为镜像仓库设置新的目标。

| **配置项**   | **描述**                                                   |
| ------------ | ---------------------------------------------------------- |
| **提供者**   | 标识镜像仓库服务的提供者，例如 Harbor。                    |
| **名称**     | 为新增目标输入名称。                                       |
| **目标 URL** | 输入镜像仓库的 URL 地址，用于访问仓库。                    |
| **用户名**   | 输入访问镜像仓库的用户名。                                 |
| **密码**     | 输入与用户名对应的密码。                                   |
| **备注**     | 输入关于此目标的备注内容，如用途、创建日期或其他相关信息。 |

3. 同步管理

镜像仓库同步管理是一套机制，用于自动或手动将一个镜像仓库中的镜像更新同步到其他仓库。

![Ui6NbR2ZOolKHMxzWZHcf3XFnTb](/static/Ui6NbR2ZOolKHMxzWZHcf3XFnTb.png)

使用方法：

- 在列表中选中特定的镜像，点击【同步】，可复制镜像管理规则。
- 通过【操作】可对相应目标进行【更新】或【删除】。
- 新增策略：在镜像仓库同步管理中，新增策略允许用户定义同步操作的具体行为和参数。点击【新增策略】可为镜像仓库设置新的策略。

| **配置项**       | **描述**                                                     |
| ---------------- | ------------------------------------------------------------ |
| **名称**         | 必填。输入新增策略的名称。                                   |
| **描述**         | 提供策略的详细描述。                                         |
| **复制模式**     | **Push-based**：把资源由本地 Harbor 推送到远端仓库。**Pull-based**：把资源由远端仓库拉取到本地 Harbor。 |
| **源仓库**       | 从下拉列表中选择源仓库。                                     |
| **源资源过滤器** | 设置用于筛选同步的源镜像资源的条件。                         |
| **目标**         | **名称空间**：指定目标仓库中的命名空间。**仓库扁平化**：- **无替换**：不替换目标仓库中的任何镜像。- **替换所有级**：替换目标仓库中所有层级的镜像，不考虑其版本或标签。- **替换 1 级**：仅替换目标仓库中第一层级（通常是最顶层）的镜像。- **替换 2 级**：替换目标仓库中第二层级的镜像，适用于更具体的分类或版本。- **替换 3 级**：替换目标仓库中第三层级的镜像，适用于更详细的版本控制。 |
| **触发模式**     | **手动**：用户直接干预，通过手动操作来启动任务。**定时**：根据预定的时间表或周期性计划来启动任务。**事件驱动**：根据特定事件的发生来启动任务。 |
| **带宽**         | 设置同步操作的带宽使用限制，以 Kbps 或 Mbps 为单位。         |
| **覆盖**         | 如果存在具有相同名称的资源，请指定是否覆盖目标上的资源。     |

4. 垃圾清理

- **当前定时任务**：允许用户设置定期执行的垃圾清理任务。
- **History**：显示垃圾清理任务的历史记录，包括执行时间、结果和可能的错误信息。

![V3CybRYlqomq8JxP5O3c0xITnie](/static/V3CybRYlqomq8JxP5O3c0xITnie.png)

![CmoIbxvl5o7pyfxuIaMcyCMUnZb](/static/CmoIbxvl5o7pyfxuIaMcyCMUnZb.png)

| **操作**         | **描述**                                                     |
| ---------------- | ------------------------------------------------------------ |
| **立即清理垃圾** | 提供一个选项，允许用户立即触发垃圾清理任务，而不是等待下一个定时周期。 |
| **保存定时任务** | 保存用户对定时任务的更改，如更改执行频率或取消定时任务。     |